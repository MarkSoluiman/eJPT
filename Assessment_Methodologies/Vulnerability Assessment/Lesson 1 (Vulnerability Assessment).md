
---

## Frequently Exploited Windows Services


| Protocol/Service                                | Ports        | Purpose                                                                                                                                                  |
| ----------------------------------------------- | ------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------- |
| MS IIS (Internet Information Services)          | TCP 80/443   | Proprietary web server software developed by MS that runs on Windows                                                                                     |
| WebDAV (Web Distributed Authoring & Versioning) | TCP 80/443   | HTTP extension that allows clients to update, delete, move and copy files on a web server. WebDAV is used to enable a web server to act like file server |
| SMB/CIFS (Server Message Block Protocol)        | TCP 445      | Network file sharing protocol that is used to share files for devices running on the same network (LAN)                                                  |
| RDP (Demote Desktop Protocol)                   | TCP 3389     | GUI remote access protocol developed by MS and is used to remotely authenticate and interact with Windows systems.                                       |
| WinRM (Windows Remote Managment Protocol)       | TCP 5986/443 | A protocol that can be used to facilitate remote access with Windows systems                                                                             |

---

## Vulnerability Scanning with MSF

As we were able to search for auxiliary modules in MSF by: `search type:auxiliary name:(service name)`, we can do the same when it comes to finding exploits for specific services by **just changing the type from auxiliary to exploit**.

We can use the tool searchsploit to search for exploits which are related to a specific version of a service which we also can find in MSF by: ` searchsploit "(name and version of service)"| grep -e "Metasploit"`

There is a useful MSF plugin we can use which is called autopwn. We can download it and follow how to install it from its GitHub repository:https://github.com/hahwul/metasploit-autopwn?tab=readme-ov-file

**We can use the analyze command in MSF to find vulnerabilities that we can perform on the target**

---

## WebDAV Vulnerabilities


Supported executable files extensions for MS IIS:
- .asp
- .aspx
- .config
- .php

In order to connect to WebDAV server, we will need to provide legitimate credentials. This is because WebDAV implements authentication in the form of a username and password.

The first step of WebDAV exploitation process if to identify whether WebDAV has been configured to run on the IIS web server. 

We can perform a brute-force attack on the WebDAV server in order to identify legitimate credentials that we can use for authentication.

After obtaining valid credentials, we can authenticate with the WebDAV server and upload a malicious .asp payload that can be used to execute arbitrary commands or obtain a reverse shell on the target.

Tools we can use:
- davtest: Used to scan, authenticate and exploit a WebDAV server. 
- cadaver: It supports file upload, download, on-screen display, in-place editing, namespace operations (move/copy), collection creation and deletion, property manipulation, and resource locking on WebDAV servers.

We use davtest after getting valid credentials like this: `davtest -auth (username:password) -url (targeturl/webdav_directory)`

This tool reveals to us what files we can upload and what file can get executed.

In order to obtain cmd access to the WebDAV directory, we will use cadaver like so: `cadaver (target_url/webdav_directory)`

**Kali Linux comes with some reverse shells scripts for web under :/usr/share/webshells/ directory**

We can use cadaver to upload a reverse shell file by: `upload (file_path)`
