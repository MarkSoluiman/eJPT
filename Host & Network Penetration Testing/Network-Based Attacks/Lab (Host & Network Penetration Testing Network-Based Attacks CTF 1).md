
---

# Lab Environment

In this lab environment, you will have GUI access to a Kali machine with access to a captured network packet file **test.pcap**.

**Objective:** Use network analysis techniques to identify and capture the following flags related to the infection and attack:

- **Flag 1:** What is the URL accessed by the infected user that returned a 200 OK response code.
- **Flag 2:** What is the IP address, MAC address of the infected Windows client?
- **Flag 3:** Which Wireshark filter can you use to determine the victim’s hostname from NetBIOS Name Service traffic, and what is the detected hostname for this malware infection?
- **Flag 4:** Which user got infected and ran the mystery_file.ps1 PowerShell script?
- **Flag 5:** What User-Agent string indicates the traffic generated by a PowerShell script?
- **Flag 6:** Which wallet extension ID is associated with the Coinbase wallet?

# Tools

The best tools for this lab are:

- Wireshark
---

To find the first flag, we will use this filter: "http.response == 200" . We only get three packets and the destination of them is 10.7.10.47. Now, to get the URL, we go to Hypertext Transfer Protocol, and under it we can see the Request URI:http://623start.site/?status=start&av=Windows%20Defender. We copy the value of that.

**First flag:** 623start.site

To find the second flag, we will need to get the MAC address. In the same packet we filtered, under Ethernet II, we will get the Destination MAC address:80:86:5b:ab:1e:c4

**Second flag:** 10.7.10.47, 80:86:5b:ab:1e:c4

To find the third flag, we will search what the filter is. The filter is nbns and after applying it, we will get name of the hostname:DESKTOP-9PEA63H

**Third flag:** nbns ,DESKTOP-9PEA63H

To find the forth flag, we will go to Edit-> Find Packet. We will search for the name of the file using Packet bytes and we make sure we clear other filters from before. We will copy the highlighted text on the bottom right panel as printable text and we paste it somewhere we can read. We will find this in the text that we copied: 'C:\Users\rwalters\Documents\mystery_file.ps1'"F-QID: 5956, Name: conhost.exe. The means the user is :"rwalters"

**Forth flag:** rwalters

To find the fifth flag, we will use the same filter that we used to get the forth flag and we will search for Powershell. We pick a packet from what we got and under Hypertext Transfer Protocol, we will see this User-Agent:Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.19041.3031.

**Fifth flag:** WindowsPowerShell

To find the sixth flag, we will use the same filter and we will search for the name of the wallet, and as we did with the infected user, we will copy the highlighted text as printable text and we will look for the name of the wallet. We will get this string next to it:"hnfanknocfeofbddgcijnmhnfnkdnaad"

**Sixth flag:** hnfanknocfeofbddgcijnmhnfnkdnaad 




