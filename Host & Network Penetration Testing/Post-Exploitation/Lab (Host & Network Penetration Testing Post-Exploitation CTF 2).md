
---

# Lab Environment

A target machine is accessible at **target.ine.local.** Identify the services and capure the flags.

- **Flag 1:** An insecure ssh user named **alice** lurks in the system.
- **Flag 2:** Using the hashdump file discovered in the previous challenge, can you crack the hashes and compromise a user?
- **Flag 3:** Can you escalate privileges and read the flag in C://Windows//System32//config directory?
- **Flag 4:** Looks like the flag present in the Administrator's home denies direct access.

The following will be useful:

- **Wordist:** /usr/share/wordlists/metasploit/unix_passwords.txt
- **Tool:** /root/Desktop/PrintSpoofer.exe

# Tools

- Nmap
- Hydra
- JohnTheRipper
- PrintSpoofer

---

We will begin with Nmap scan within MSF console: `db_nmap -Pn -A -v target.ine.local`

We will find multiple open ports but we are more interested in the 22/SSH one.

Since the lab told us that username: "alice" is weak, we will use this MSF module to crack the password of that username: "auxiliary/scanner/ssh/ssh_login"

The password that we get is princess1.

We will get two files that we need to proceed further: "flag1.txt", and "hashdump.txt"

We will upgrade the session we got using MSF to a meterpreter session: sessions -u 1.

We will download both files.

**First flag:** 5072b4a759ad4a71a0c9ea6128cc42b8

---

To get the second flag, we will need to crack the hashes we got using John The Ripper tool: `john --format=NT --wordlist= /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt hashdump.txt`

We will get a new set of credentials: "david:orange"

We will log in using ssh using these new credentials we got.

After logging in to user david, we will get the second flag.

**Second flag:** 542642095f8c414cab54311cd183c8d3

---

To get the third flag, we will need to escalate our privileges using Printspoofer.exe.

PrintSpoofer.exe is a tool that exploits the Printer Bug (also known as SpoolSample) in Windows systems to escalate privileges. It abuses the Windows Print Spooler service to impersonate a higher-privileged account, such as SYSTEM, and execute arbitrary code.

We will upload Printspoofer.exe file from our lab machine to the target machine using certutill tool in Windows cmd or using meterpreter to upload the file.

After uploading the file, we will run it like so: `Printspoofer.exe -i -c cmd.exe`

We will be user system with full privileges.

We can find the third flag under: "C:\Windows\System32\config" directory.

Third flag: "5465152cc8974cc9af560d6cbd277c20"


---

The forth flag is quite tricky, we should be able to find it under: "C:\Users\Administrator\flag" directory. However, we get an Access is denied message if we try to access that folder. After asking Chatgpt, we will need to do this: `icacls "C:\Users\Administrator\flag" /remove:d SYSTEM /t`

This command **removes explicit "Deny" permissions** for the **SYSTEM** account on the `"C:\Users\Administrator\flag"` folder and all its subfolders/files.

`icacls` (Integrity Control Access Control List) to modify permissions on the folder.
`remove:d` → Removes any **Deny** permissions for the specified user or group (in this case, `SYSTEM`).
`/t` Recursive: Applies the change to all **subfolders and files** within `"flag"`.

After that, we will be able to access the flag folder.

Forth flag: 0855547bb5d9467b9cb1462669d13b17

