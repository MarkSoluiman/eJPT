---

---

---

# Lab Environment

In this lab environment, you will be provided with GUI access to a Kali Linux machine. Two machines are accessible at **http://target1.ine.local  and **http://target2.ine.local.** 

**Objective:** Execute Post-Exploitation techniques on the target to uncover hidden flags and fully exploit the compromised environment.

**Flags to Capture:**

- **Flag 1**: The file that stores user account details is worth a closer look. (target1.ine.local)
- **Flag 2**: User groups might reveal more than you expect.
- **Flag 3**: Scheduled tasks often have telling names. Investigate the cron jobs to uncover the secret.
- **Flag 4**: DNS configurations might point you in the right direction. Also, explore the home directories for stored credentials.
- **Flag 5**: Use the discovered credentials to gain higher privileges and explore the root's home directory on target2.ine.local.

# Tools

The best tools for this lab are:

- Nmap
- SSH
- OpenSSL

---

## First target

We will start with our Nmap scan: `nmap -Pn -A -p- -v target1.ine.local -oX target1`

We will find one port open: 22/SSH.

The version of ssh that is running on this port is libssh 0.8.3 which is vulnerable to auth-bypass vulnerability using this MSF module:"scanner/ssh/libssh_auth_bypass"

To get a reverse shell, we need to set this option: "spawn_pty" to true, and we also need to set rhosts to the target IP address.

We run the module and we get a reverse shell on the target machine.

The first flag could be found in "/etc/passwd" file.

**First flag:** 505f075f2ce946b6a87c0483af4a5924

---

There are interesting credentials in:"/home/user/credentials.txt" file. The credentials are: "john:Pass@john123". 

We will keep that in mind.

To find the second flag, we will read the content of this file: "/etc/group"

**Second flag:** e3462796d5c04dc5889c6a17d8dcc048

---

To get the third flag, we will need to list cron jobs: `ls -la /etc/cron*`

The third flag will be a name of a file under: "/etc/cron.d" directory.

**Third flag:** a340ee137eaa47f6b346211fe827a14b

---

To find the forth flag, we will need to read the content of: "/etc/hosts" file.

**Forth flag:** ba2a1bf666f5493d9dea4587f3abfe5e

---

### Second target

To get the fifth flag, we will need to login to the second target using ssh. 

If we did a scan using Nmap on the second target, we will find that only one open port which is 22/SSH.

We will use the credentials we got earlier: `ssh john@192.6.165.3`

We will get a SSH session on the second target machine.

We will try to find files that we can write to: `find / -not -type l -perm -o+w`

This will reveal a crucial vulnerability as we can write to file /etc/shadow which contain users' passwords.

We will create a new password for user root using openssl on our local machine: `openssl passwd -6 pass123`

We will copy the hash that we got.

We will open the shadow file using nano: `nano /etc/shadow`

Next to user root, we will paste the hash we got between the first two colons.

We will save the file.

After that, we will login to root user using the password we specified: `su - root`

We are now logged in as root.

fifth flag will be in: "/root/flag.txt"

**Fifth flag:** 273a3b1fb6d34122b72da66fedf46f23 
