
# Lab Environment

Two Linux machines are accessible at **target1.ine.local** and **target2.ine.local**. Identify the application and service running on these machines, and capture the flags. The flag is an md5 hash format.

- **Flag 1:** Identify and exploit the vulnerable web application running on **target1.ine.local** and retrieve the flag from the root directory. The credentials **admin:password1** may be useful.
- **Flag 2:** Further, identify and compromise an insecure system user on **target1.ine.local**.
- **Flag 3:** Identify and exploit the vulnerable plugin used by the web application running on **target2.ine.local** and retrieve the **flag3.txt** file from the root directory.
- **Flag 4:** Further, identify and compromise a system user requiring no authentication on **target2.ine.local**.

The following wordlists will be useful:

- /usr/share/nmap/nselib/data/wp-plugins.lst
- /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt
---

### First Target

We will run our Nmap scan within MSF: `db_nmap -Pn -A -v target1.ine.local`

We will get two ports open: 22/ssh, and 80/http.

Since we don't have credentials for ssh, we will check the website running on port 80.

The website appears to be running a web content management called flatcore with login page.

We will try to use the credentials we have been given to access the admin dashboard.

After we login, we will click on: "Administration", this will bring us to the admin dashboard. 

At the bottom of the page, we can see the version of flatcore being used: "2.0.7B"

We will search for an exploit that targets the same version using searchsploit: `searchsploit flatcore 2.0.7` We will get this exploit: "FlatCore CMS 2.0.7 - Remote Code Execution (RCE) (Authenticated) "

We will run it with python like so: `python3 ./50262.py 'http://target1.ine.local/' 'admin' 'password1'`

This will give us a reverse shell. However, we cant change our current directory, so it is not very functional shell. 

However, we can get the first flag from the root directory: `cat /flag1.txt`

**First flag**:cec2daa05f584f9594242fd3ff2a8ef1

--- 
To get the second flag, we will need to know what users are on the target machine: `cat /etc/passwd`

We see a user called: "iamaweakuser". Maybe that is a hint that we can brute-force the password for this user using Hydra.

We will use Hydra to login to that user using ssh: `hydra -l iamaweakuser -P /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt 192.206.75.3 ssh`

The password for this user is angel.

To login using ssh: `iamaweakuser@92.206.75.3` and we provide the password that we got.

We list the content of our current folder and we can see the file with the second flag.

**Second flag:** 41e8e548b66746dcbc6284e45f077e3f

---

## Second Target

We will run our Nmap scan within MSF: `db_nmap -Pn -A -v target2.ine.local`

We also get two open ports, 22/ssh, and 80/http

We will visit the website running on port 80. We find that the website is running wordpress.

We will use this Nmap script to scan the website further: "http-wordpress-enum.nse" :
`nmap -A -p80 --script=http-wordpress-enum.nse -v 192.206.75.4`

We find two plugins: akismet 5.0.1, and duplicator 1.3.26.

If we searched for the first plugin using MSF, we don't find anything, however, if we searched for the second one, we will get this exploit module:"scanner/http/wp_duplicator_file_read"

Using this module, we can read files within the target system.

The module filepath is already set to "etc/passwd" file which will reveal a user without credentials to login using ssh.

After running the module, we see a user called: "iamacrazyfreeuser" 

We will try to login using this username via ssh: `ssh iamacrazyfreeuser@192.206.75.4`

Indeed, we dont need a password to login as "iamacrazyfreeuser".

We find the forth flag right away if we list the content of our current folder.

**Forth flag:** ba5641094a994a9a8a19cb620e00baca

--- 

To get the third flag, we will need to first find it. We find it under the root directory. However, we don't have permission to read it.

We will use the previous module to read the third flag. All what we have to do is to set the filepath option to: "/flag3.txt"

When we run the module, we get the third flag.

**Third flag:** 6794a469affb46ad8fd1a8a112dfe681



